!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("FourCorners",[],t):"object"==typeof exports?exports.FourCorners=t():e.FourCorners=t()}(window,function(){return function(r){var n={};function a(e){if(n[e])return n[e].exports;var t=n[e]={i:e,l:!1,exports:{}};return r[e].call(t.exports,t,t.exports,a),t.l=!0,t.exports}return a.m=r,a.c=n,a.d=function(e,t,r){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(a.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)a.d(r,n,function(e){return t[e]}.bind(null,n));return r},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=0)}([function(e,t,r){e.exports=r(2)},function(e,t,r){},function(e,t,r){"use strict";r.r(t);r(1);function f(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=[],n=!0,a=!1,o=void 0;try{for(var c,s=e[Symbol.iterator]();!(n=(c=s.next()).done)&&(r.push(c.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==s.return||s.return()}finally{if(a)throw o}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a=function(){function o(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),this.elems={},this.opts=t,this.corners=["context","links","authorship","backstory"],this.elems.embed=e,this.data=y(this),this.elems.photo=i(this),this.elems.panels=d(this),this.elems.corners=h(this),this.elems.caption=b(this),c(this)}var e,t,r;return e=o,(t=[{key:"init",value:function(e){var n=this,a=(n.embeds=[],Object.assign({selector:".fc-embed:not(.fc-init)",noPanels:!1,noCorners:!1,cornerStroke:"6px",cornerSize:"25px",cornerColor:"white",cornerActiveColor:"blue",cornerHoverColor:"red",posDur:.2,transDur:.1},e));return Array.from(document.querySelectorAll(a.selector)).forEach(function(e,t){var r=new o(e,a);n.embeds.push(r)}),n.embeds}},{key:"openCorner",value:function(r){var n=this,e=this.corners,t=this.elems.embed,a=this.elems.corners[r],o=this.elems.panels[r];a&&o&&(t.dataset.active=r,t.classList.add("fc-active"),a.classList.add("fc-active"),o.classList.add("fc-active")),e.forEach(function(e,t){e!=r&&n.closeCorner(e)})}},{key:"closeCorner",value:function(e){var t=this.elems.embed;e||(e=t.dataset.active);var r=this.elems.corners[e],n=this.elems.panels[e];e==t.dataset.active&&(t.dataset.active="",t.classList.remove("fc-active")),r&&r.classList.remove("fc-active"),n&&n.classList.remove("fc-active")}}])&&n(e.prototype,t),r&&n(e,r),o}(),c=function(a){var e=a.elems.embed;e.classList.add("fc-init"),a.data&&a.data.dark&&e.classList.add("fc-dark"),e.addEventListener("mouseenter",function(e){g(e,a)}),e.addEventListener("mouseleave",function(e){E(e,a)}),window.addEventListener("resize",function(e){o(e,a)}),window.addEventListener("click",function(e){var t=x(e.target,a.elems.panels),r=x(e.target,a.elems.corners),n=x(e.target,Array.from(document.querySelectorAll("#creator")));t||r||n||a.closeCorner()}),o(null,a)},o=function(e,t){var r=t.elems.panels;r&&Object.keys(r).forEach(function(e,t){s(r[e])})},s=function(e){var t=e.querySelector(".fc-scroll");t&&(t.scrollHeight>t.clientHeight?e.classList.add("fc-overflow"):e.classList.remove("fc-overflow"))},i=function(e){var t=e.elems.embed,r=document.createElement("img");r.classList.add("fc-img");var n="",a=".fc-photo";if(t.querySelector(a))n=t.querySelector(a);else{(n=document.createElement("div")).classList.add("fc-photo");var o=new Image,c=e.data.photo;if(!c)return;var s=c.file;o.onload=function(e){r.src=s,n.classList.add("fc-loaded")},o.onerror=function(e){console.log(e)},o.src=s,n.appendChild(r)}return t.appendChild(n),n},d=function(d){var l={},u=d.elems.embed;return d.corners.forEach(function(e,t){var r=null;if(d.data){r=d.data[e];var n=Object.keys(r);if(!r||!n.length)return}var a,o='.fc-panel[data-slug="'+e+'"]';if(u.querySelector(o))a=u.querySelector(o);else{(a=document.createElement("div")).classList.add("fc-panel"),a.dataset.slug=e;var c=document.createElement("div");c.classList.add("fc-scroll");var s=document.createElement("div");s.classList.add("fc-inner");var i=document.createElement("div");i.classList.add("fc-panel-title"),s.appendChild(i),i.innerHTML=e,r&&Object.entries(r).forEach(function(e){var t=f(e,2),r=t[0],n=t[1];if(n){var a=document.createElement("div");a.classList.add("fc-row","fc-"+r),"media"==r?a.append(m(n)):"links"==r?a.append(p(n)):(n=j(n),a.innerHTML+=n),s.appendChild(a)}}),c.appendChild(s),a.appendChild(c),u.appendChild(a)}l[e]=a}),l},m=function(e){var a=document.createElement("div");return a.className="fc-sub-rows",e.forEach(function(e,t){var r=document.createElement("div");if(r.className="fc-sub-row","image"==e.type?l(e,r):u(e,r),e.credit){var n=document.createElement("div");n.className="fc-sub-credit",n.innerHTML=e.credit,r.appendChild(n)}a.appendChild(r)}),a},l=function(e,t){var r=document.createElement("div");r.className="fc-media";var n=document.createElement("img");n.src=e.url,r.appendChild(n),t.prepend(r)},u=function(e,n){var t="";switch(e.type){case"youtube":t="https://www.youtube.com/oembed?url="+e.url;break;case"vimeo":t="https://vimeo.com/api/oembed.json?url="+e.url;break;case"soundcloud":t="https://soundcloud.com/oembed?format=json&url="+e.url;break;default:return!1}var r=new Headers;fetch(t,{method:"GET",headers:r,mode:"cors",cache:"default"}).then(function(e){if(!e.ok)throw Error(e.statusText);return e.json()}).then(function(e){var t=document.createElement("div");if(t.className="fc-media",t.innerHTML=e.html,Number.isInteger(e.width,e.height)){var r=e.height/e.width;t.classList.add("fc-responsive"),t.style.paddingBottom=100*r+"%"}n.prepend(t)}).catch(function(e){n.remove(),console.log(e)})},p=function(e){var c=document.createElement("div");return c.className="fc-sub-rows",e.forEach(function(e,t){var r=document.createElement("div");r.className="fc-sub-row";var n=document.createElement("a");n.href=e.url,n.target="_blank",e.title&&(n.innerHTML=e.title),r.appendChild(n);var a=v(e.url);if(a){var o=document.createElement("div");o.className="fc-sub-url",o.innerHTML=a,r.appendChild(o)}c.appendChild(r)}),c},v=function(e){var t,r=(-1<(t=e).indexOf("//")?t.split("/")[2]:t.split("/")[0]).split(":")[0].split("?")[0],n=r.split("."),a=n.length;return 2<a&&(r=n[a-2]+"."+n[a-1],2==n[a-2].length&&2==n[a-1].length&&(r=n[a-3]+"."+r)),r},h=function(a){var o,c={},s=a.elems.embed;a.elems.photo;return a.corners.forEach(function(e,t){var r='.fc-corner[data-slug="'+e+'"]';if(!s.querySelector(r)){var n=document.createElement("div");n.dataset.slug=e,n.classList.add("fc-corner"),a.data&&((o=a.data[e])&&Object.keys(o).length||n.classList.add("fc-inactive")),n.addEventListener("mouseenter",function(e){L(e,a)}),n.addEventListener("mouseleave",function(e){w(e,a)}),n.addEventListener("click",function(e){C(e,a)}),c[e]=n,s.appendChild(n)}}),c},b=function(e){if(e.data){var t=e.data.authorship;if(t&&Object.keys(t).length){var r=e.elems.embed,n=document.createElement("div");n.classList.add("fc-caption");var a=[];t.credit&&a.push(t.credit),t.copyright&&a.push("&copy;");a.push('<a href="#">Four Corners</a>');var o=a.join(" ");n.innerHTML=o,r.parentNode.insertBefore(n,r.nextSibling)}}},y=function(e){var t=e.elems.embed.dataset.fc;if(t)return t=t,delete e.elems.embed.dataset.fc,JSON.parse(t)},g=function(e,t){t.elems.embed,t.elems.corners,t.css,t.opts.posDur},E=function(e,t){t.elems.embed,t.elems.corners,t.css,t.opts.posDur},L=function(e,t){e.target.classList.add("fc-hover")},w=function(e,t){e.target.classList.remove("fc-hover")},C=function(e,t){var r=e.target.dataset.slug,n=t.elems.embed.dataset.active;r&&(r==n?t.closeCorner(r):t.openCorner(r))},x=function(r,e){var n=!1;return Object.entries(e).forEach(function(e){var t=f(e,2);t[0];t[1].contains(r)&&(n=!0)}),n},j=function(e){return e.replace(/(?:(?:https?|ftp):\/\/)?(?:\S+(?::\S*)?@)?(?:(?!10(?:\.\d{1,3}){3})(?!127(?:\.\d{1,3}){3})(?!169\.254(?:\.\d{1,3}){2})(?!192\.168(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\x{00a1}\-\x{ffff}0-9]+-?)*[a-z\x{00a1}\-\x{ffff}0-9]+)(?:\.(?:[a-z\x{00a1}\-\x{ffff}0-9]+-?)*[a-z\x{00a1}\-\x{ffff}0-9]+)*(?:\.(?:[a-z\x{00a1}\-\x{ffff}]{2,})))(?::\d{2,5})?(?:\/[^\s]*)?/gi,function(e){return'<a href="'+(/^(?:(?:https?|ftp):\/\/)/i.test(e)?e:"http://"+e)+'" target="_blank">'+e+"</a>"})},k=a;t.default=k}])});