!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("FourCorners",[],e):"object"==typeof exports?exports.FourCorners=e():t.FourCorners=e()}(window,function(){return function(n){var c={};function a(t){if(c[t])return c[t].exports;var e=c[t]={i:t,l:!1,exports:{}};return n[t].call(e.exports,e,e.exports,a),e.l=!0,e.exports}return a.m=n,a.c=c,a.d=function(t,e,n){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},a.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var c in e)a.d(n,c,function(t){return e[t]}.bind(null,c));return n},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="",a(a.s=0)}([function(t,e,n){t.exports=n(2)},function(t,e,n){},function(t,e,n){"use strict";n.r(e);n(1);function c(t){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],c=!0,a=!1,r=void 0;try{for(var i,o=t[Symbol.iterator]();!(c=(i=o.next()).done)&&(n.push(i.value),!e||n.length!==e);c=!0);}catch(t){a=!0,r=t}finally{try{c||null==o.return||o.return()}finally{if(a)throw r}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function a(t,e){for(var n=0;n<e.length;n++){var c=e[n];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(t,c.key,c)}}var i=function(){function r(t,e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),this.elems={},this.opts=e,this.corners=["authorship","backstory","imagery","links"],this.cornerTitles=["Authorship","Backstory","Related Imagery","Links"],this.elems.embed=t,this.data=L(this),this.elems.photo=f(this),this.elems.panels=d(this),this.elems.corners=y(this),this.elems.caption=g(this),o(this)}var t,e,n;return t=r,(e=[{key:"init",value:function(t){var c=this;c.embeds=[];var a=Object.assign({selector:".fc-embed:not(.fc-init)",interactive:!0,active:null,cutline:!0,posDur:.2,transDur:.1},t);return Array.from(document.querySelectorAll(a.selector)).forEach(function(t,e){var n=new r(t,a);c.embeds.push(n)}),c.embeds}},{key:"getPanel",value:function(t){var e=this.elems.embed;if(e){var n=".fc-panel";return t?(n+='[data-fc-slug="'+t+'"]',e.querySelector(n)):e.querySelectorAll(n)}}},{key:"openPanel",value:function(n){var c=this,t=c.corners,e=c.elems.embed,a=c.elems.corners[n],r=c.getPanel(n);e.classList.remove("fc-full"),e&&a&&r&&(e.dataset.fcActive=n,e.classList.add("fc-active"),a.classList.add("fc-active"),r.classList.add("fc-active")),t.forEach(function(t,e){t!=n&&c.closePanel(t)})}},{key:"closePanel",value:function(t){var e=this.elems.embed;if(t||(t=e.dataset.fcActive),t){var n=this.elems.corners[t],c=this.getPanel(t);t==e.dataset.fcActive&&(e.dataset.fcActive="",e.classList.remove("fc-active")),n&&n.classList.remove("fc-active"),c&&c.classList.remove("fc-active")}}},{key:"toggleExpandPanel",value:function(){this.elems.embed.classList.toggle("fc-full")}}])&&a(t.prototype,e),n&&a(t,n),r}(),o=function(a){var t=a.elems.embed;t.classList.add("fc-init"),a.data&&a.data.opts&&a.data.opts.dark&&t.classList.add("fc-dark"),a.opts.interactive&&(window.addEventListener("resize",function(t){s(t,a)}),window.addEventListener("click",function(t){var e=S(t.target,a.getPanel()),n=S(t.target,a.elems.corners),c=S(t.target,Array.from(document.querySelectorAll("#creator")));e||n||c||(a.closePanel(),a.elems.embed.classList.remove("fc-full"))})),s(null,a)},s=function(t,e){var n=e.getPanel();n&&Object.keys(n).forEach(function(t,e){l(n[t])})},l=function(t){if("function"==typeof t.querySelector){var e=t.querySelector(".fc-scroll");e&&(e.scrollHeight>e.clientHeight?t.classList.add("fc-overflow"):t.classList.remove("fc-overflow"))}},f=function(t){var e=t.elems.embed;if(t.data){var n,c,a=".fc-photo";e.querySelector(a)?n=e.querySelector(a):(n='<div class="fc-photo"></div>',e.innerHTML+=n);return(c=e.querySelector(".fc-img"))&&(e.classList.add("fc-loaded"),e.appendChild(c)),n}},d=function(i){var c={};i.elems.embed;return i.corners.forEach(function(t,e){i.opts.active;if(!i.getPanel(t)){var n="";if(i.data&&i.data[t]){var c=i.data[t];switch(t){case"authorship":n=u(i,c);break;case"backstory":n=v(i,c);break;case"imagery":n=p(i,c);break;case"links":n=m(i,c)}}var a=i.cornerTitles[e],r='<div data-fc-slug="'.concat(t,'" class="fc-panel fc-').concat(t,'">\n\t\t\t\t\t<div class="fc-panel-title">\n\t\t\t\t\t\t<span>').concat(a,'</span>\n\t\t\t\t\t\t<div class="fc-icon fc-expand"></div>\n\t\t\t\t\t\t<div class="fc-icon fc-close"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="fc-panel-title fc-pseudo">\n\t\t\t\t\t\t<span>').concat(i.corners.indexOf(t),"</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t").concat(n?'<div class="fc-scroll">\n\t\t\t\t\t\t<div class="fc-inner">\n\t\t\t\t\t\t\t'.concat(n,"\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>"):"","\n\t\t\t\t</div>");i.elems.embed.innerHTML+=r}}),i.corners.forEach(function(e,t){var n=i.getPanel(e);(c[e]=n).querySelector(".fc-expand").addEventListener("click",function(t){i.toggleExpandPanel()}),n.querySelector(".fc-close").addEventListener("click",function(t){i.closePanel(e),i.elems.embed.classList.remove("fc-full")})}),c},u=function(t,e){var n,c=O(e,"license","label")&&"copyright"==e.license.type,a="";return a+=e.caption?'<div class="fc-field">\n\t\t\t<em>'.concat(e.caption,"</em>\n\t\t</div>"):"",a+=O(e,"license","credit")||c?'<div class="fc-field" data-fc-field="credit">\n\t\t\t\t<div class="fc-content">\n\t\t\t\t\t'.concat(c?'<span class="fc-copyright">\n\t\t\t\t\t\t\t'.concat(O(e,"license","label")?"<span>".concat(e.license.label,"</span>"):"","\n\t\t\t\t\t\t</span>"):"","\n\t\t\t\t\t").concat(O(e,"credit")?e.credit:"","\n\t\t\t\t</div>\n\t\t\t</div>"):"",a+=e.license&&"commons"==e.license.type?'<div class="fc-field" data-fc-field="license">\n\t\t\t\t<span class="fc-label">License</span>\n\t\t\t\t<span class="fc-content">\n\t\t\t\t\t'.concat(e.license.url?'<a href="'.concat(e.license.url,'" target="_blank">\n\t\t\t\t\t\t').concat(e.license.label?e.license.label:"","\n\t\t\t\t\t</a>"):e.license.label?e.license.label:"","\n\t\t\t\t</span>\n\t\t\t</div>"):"",a+=e.ethics?'<div class="fc-field">\n\t\t\t<span class="fc-label">Code of ethics</span>\n\t\t\t'.concat(e.ethics,"\n\t\t</div>"):"",a+=e.bio?'<div class="fc-field">\n\t\t\t<span class="fc-label">Bio</span>\n\t\t\t'.concat(e.bio,"\n\t\t</div>"):"",(a+=e.website||e["0-contact"]||e["1-contact"]?'<div class="fc-field fc-contact">\n\n\t\t\t'.concat(e.website?'<div class="fc-field fc-card">\n\t\t\t\t<div class="fc-label">Website</div>\n\t\t\t\t'.concat(x(e.website),"\n\t\t\t</div>"):"","\n\n\t\t\t").concat(e["0-contact"]?'<div class="fc-field fc-card">\n\t\t\t\t<div class="fc-label">For more info contact</div>\n\t\t\t\t'.concat(x(e["0-contact"]),"\n\t\t\t</div>"):"","\n\n\t\t\t").concat(e["1-contact"]?'<div class="fc-field fc-card">\n\t\t\t\t<div class="fc-label">For reproduction rights contact</div>\n\t\t\t\t'.concat(x(e["1-contact"]),"\n\t\t\t</div>"):"","\n\n\t\t</div>"):"").length&&(n='<div class="fc-row">'.concat(a,"</div>")),n},v=function(n,t){return"".concat(t.text?'<div class="fc-row">\n\t\t\t'.concat(E(t.text),"\n\t\t</div>"):"","\n\t\t").concat(t.media?t.media.map(function(t,e){return h(n,t,"backstory",e),'<div class="fc-row">\n\t\t\t\t<div class="fc-media">\n\t\t\t\t</div>\n\t\t\t\t'.concat(t.caption?'<div class="fc-sub-caption">'.concat(t.caption,"</div>"):"","\n\t\t\t\t").concat(t.credit?'<div class="fc-sub-credit">'.concat(t.credit,"</div>"):"","\n\t\t\t</div>")}).join(""):"")},p=function(n,t){if(t.media)return"".concat(t.media.map(function(t,e){return"image"!=t.source&&t.source?h(n,t,"imagery",e):b(n,t,"imagery",e),'<div class="fc-row">\n\t\t\t\t<div class="fc-media">\n\t\t\t\t</div>\n\t\t\t\t'.concat(t.caption?'<div class="fc-sub-caption">'.concat(t.caption,"</div>"):"","\n\t\t\t\t").concat(t.credit?'<div class="fc-sub-credit">'.concat(t.credit,"</div>"):"","\n\t\t\t</div>")}).join(""))},m=function(t,e){if(e.links)return e.links.map(function(t){if(!t||!t.url)return null;var e=P(t.url),n=t.url?"".concat(t.title?t.title:e,'\n\t\t\t<div class="fc-sub-url">').concat(e,"</div>"):"";return'<div class="fc-row">'.concat(x(t.url,n,["fc-card"]),"</div>")}).join("")},b=function(n,c,a,r){if(c.url){var t=new Image;t.onload=function(t){var e='<img src="'.concat(c.url,'"/>');n.elems.panels[a].querySelectorAll(".fc-media")[r].innerHTML+=e},t.onerror=function(t){console.warn("Four Corners cannot load this as an image: "+c.url,t)},t.src=c.url}},h=function(c,t,a,r){var e="";switch(t.source){case"youtube":e="https://noembed.com/embed?url="+t.url;break;case"vimeo":e="https://vimeo.com/api/oembed.json?url="+t.url;break;case"soundcloud":e="https://soundcloud.com/oembed?format=json&url="+t.url;break;default:return!1}fetch(e,{method:"GET",headers:{"Content-Type":"application/json"}}).then(function(t){if(!t.ok)throw Error(t.statusText);return t.json()}).then(function(t){var e=c.elems.panels[a].querySelectorAll(".fc-media")[r];if(Number.isInteger(t.width,t.height)){var n=t.height/t.width;e.classList.add("fc-responsive"),e.style.paddingBottom=100*n+"%"}e.innerHTML=t.html}).catch(function(t){console.warn("Four Corners cannot load this media source: "+src,t)})},y=function(a){var r,i={},o=a.elems.embed,s=(a.elems.photo,a.opts.active);return a.corners.forEach(function(t,e){var n='.fc-corner[data-fc-slug="'+t+'"]';if(!o.querySelector(n)){var c=document.createElement("div");c.dataset.fcSlug=t,c.classList.add("fc-corner"),c.classList.add("fc-"+t),t==s&&c.classList.add("fc-active"),a.data&&((r=a.data[t])&&Object.keys(r).length||c.classList.add("fc-empty")),a.opts.interactive&&(c.addEventListener("mouseenter",function(t){k(t,a)}),c.addEventListener("mouseleave",function(t){w(t,a)}),c.addEventListener("click",function(t){j(t,a)})),i[t]=c,o.appendChild(c)}}),i},g=function(t){if(t.data&&t.opts.cutline){var e=t.data.authorship,n=t.elems.embed,c=document.createElement("div");if(c.classList.add("fc-cutline"),e.credit){var a=document.createElement("span");a.classList.add("fc-credit"),a.innerHTML=e.credit,c.appendChild(a)}var r=document.createElement("a");r.classList.add("fc-link"),r.href="https://fourcornersproject.org",r.target="_blank",c.appendChild(r),n.parentNode.insertBefore(c,n.nextSibling)}},L=function(t){if(t.elems.embed){var e=t.elems.embed.dataset.fc;if(e)return e=e,delete t.elems.embed.dataset.fc,JSON.parse(e)}},k=function(t,e){t.target.classList.add("fc-hover")},w=function(t,e){t.target.classList.remove("fc-hover")},j=function(t,e){var n=t.target.dataset.fcSlug,c=e.elems.embed.dataset.fcActive;n&&(n==c?e.closePanel(n):e.openPanel(n))},S=function(c,t){var a=!1;return Object.entries(t).forEach(function(t){var e=r(t,2),n=(e[0],e[1]);n&&n.contains(c)&&(a=!0)}),a},E=function(t){var e=t.split(/\n/g);return e?"".concat(e.map(function(t,e){return t?"<p>".concat(t,"</p>"):"<br/>"}).join("")):""},x=function(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:[];return e||(e=P(t)),-1<t.indexOf("@")&&(t="mailto:"+t),'<a href="'.concat(t,'" target="_blank" class="').concat(n.join(" "),'">').concat(e,"</a>")},P=function(t){if(!t)return!1;var e,n=!!(e=t)&&(-1<e.indexOf("//")?e.split("/")[2]:e.split("/")[0]).split(":")[0].split("?")[0],c=n.split("."),a=c.length;return 2<a&&(n=c[a-2]+"."+c[a-1],2==c[a-2].length&&2==c[a-1].length&&(n=c[a-3]+"."+n)),n},O=function(t,e,n){if(!t)return!1;if(!t[e])return!1;if("object"==c(t[e])){if(!Object.keys(t[e]).length)return!1}else if(!t[e].length)return!1;if(!n||!t[e][n])return!1;if("object"==c(t[e][n])){if(!Object.keys(t[e][n]).length)return!1}else if(!t[e][n].length)return!1;return!0},A=i;e.default=A}])});