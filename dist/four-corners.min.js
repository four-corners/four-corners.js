!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("FourCorners",[],t):"object"==typeof exports?exports.FourCorners=t():e.FourCorners=t()}(window,function(){return function(n){var r={};function a(e){if(r[e])return r[e].exports;var t=r[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,a),t.l=!0,t.exports}return a.m=n,a.c=r,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)a.d(n,r,function(e){return t[e]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=0)}([function(e,t,n){e.exports=n(2)},function(e,t,n){},function(e,t,n){"use strict";n.r(t);n(1);function h(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,a=!1,c=void 0;try{for(var i,o=e[Symbol.iterator]();!(r=(i=o.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,c=e}finally{try{r||null==o.return||o.return()}finally{if(a)throw c}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=function(){function c(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),this.elems={},this.opts=t,this.corners=["context","links","authorship","backstory"],this.cornerTitles=["Image Context","Links","Authorship","Backstory"],this.elems.embed=e,this.data=v(this),this.elems.photo=s(this),this.elems.panels=l(this),this.elems.corners=m(this),this.elems.caption=p(this),i(this)}var e,t,n;return e=c,(t=[{key:"init",value:function(e){var r=this;r.embeds=[];var a=Object.assign({selector:".fc-embed:not(.fc-init)",interactive:!0,active:null,cutline:!0,posDur:.2,transDur:.1},e);return Array.from(document.querySelectorAll(a.selector)).forEach(function(e,t){var n=new c(e,a);r.embeds.push(n)}),r.embeds}},{key:"openCorner",value:function(n){var r=this,e=this.corners,t=this.elems.embed,a=this.elems.corners[n],c=this.elems.panels[n];t.classList.remove("fc-full"),t&&a&&c&&(t.dataset.fcActive=n,t.classList.add("fc-active"),a.classList.add("fc-active"),c.classList.add("fc-active")),e.forEach(function(e,t){e!=n&&r.closeCorner(e)})}},{key:"closeCorner",value:function(e){var t=this.elems.embed;e||(e=t.dataset.fcActive);var n=this.elems.corners[e],r=this.elems.panels[e];e==t.dataset.fcActive&&(t.dataset.fcActive="",t.classList.remove("fc-active")),n&&n.classList.remove("fc-active"),r&&r.classList.remove("fc-active")}},{key:"toggleExpandPanel",value:function(){this.elems.embed.classList.toggle("fc-full")}}])&&r(e.prototype,t),n&&r(e,n),c}(),i=function(a){var e=a.elems.embed;e.classList.add("fc-init"),a.data&&a.data.opts&&a.data.opts.dark&&e.classList.add("fc-dark"),a.opts.interactive&&(window.addEventListener("resize",function(e){c(e,a)}),window.addEventListener("click",function(e){var t=k(e.target,a.elems.panels),n=k(e.target,a.elems.corners),r=k(e.target,Array.from(document.querySelectorAll("#creator")));t||n||r||a.closeCorner()})),c(null,a)},c=function(e,t){var n=t.elems.panels;n&&Object.keys(n).forEach(function(e,t){o(n[e])})},o=function(e){var t=e.querySelector(".fc-scroll");t&&(t.scrollHeight>t.clientHeight?e.classList.add("fc-overflow"):e.classList.remove("fc-overflow"))},s=function(e){var t=e.elems.embed;if(e.data){var n,r,a=".fc-photo";t.querySelector(a)?n=t.querySelector(a):((n=document.createElement("div")).classList.add("fc-photo"),t.appendChild(n));return(r=t.querySelector(".fc-img"))&&(n.classList.add("fc-loaded"),n.appendChild(r)),n}},l=function(m){var p={},v=m.elems.embed;return m.corners.forEach(function(e,t){var n=m.opts.active,r='.fc-panel[data-fc-slug="'+e+'"]',a=v.querySelector(r);if(!a){(a=document.createElement("div")).dataset.fcSlug=e,a.classList.add("fc-panel"),a.classList.add("fc-"+e),e==n&&a.classList.add("fc-active");var c=document.createElement("div");c.classList.add("fc-scroll");var u=document.createElement("div");u.classList.add("fc-inner");var i=document.createElement("div");i.classList.add("fc-panel-title");var o=document.createElement("span"),s=m.cornerTitles[m.corners.indexOf(e)];o.innerHTML=s,i.appendChild(o);var l=document.createElement("div");l.className="fc-icon fc-expand",l.addEventListener("click",function(e){m.toggleExpandPanel(e,m)}),i.appendChild(l);var d=document.createElement("div");if(d.className="fc-icon fc-close",d.addEventListener("click",function(e){w(e,m)}),i.appendChild(d),u.appendChild(i),m.data){var f=m.data[e];Object.keys(f);Object.entries(f).forEach(function(e){var t=h(e,2),n=t[0],r=t[1];if(r){var a=document.createElement("div");if(a.classList.add("fc-row","fc-"+n),"media"==n){var c=b(r);c&&a.appendChild(c)}else if("links"==n){var i=y(r);i&&a.appendChild(i)}else if("license"==n){var o=g(r);o&&a.appendChild(o)}else if("ethics"==n)a.innerHTML=r;else if("copyright"==n)a.innerHTML="&copy; "+r;else if("text"==n){var s=j(r);s&&a.appendChild(s)}else a.innerHTML+=r;var l={credit:"Photography by",ethics:"Code of ethics",caption:"Caption"}[n];if(a.childNodes.length){if(l){var d=document.createElement("div");d.classList.add("fc-row-label"),d.innerHTML=l,a.childNodes?a.insertBefore(d,a.childNodes[0]):a.appendChild(d)}u.appendChild(a)}}}),Object.keys(f).length||a.classList.add("fc-empty")}c.appendChild(u),a.appendChild(c),v.appendChild(a)}p[e]=a}),p},b=function(e){var a=["youtube","vimeo","soundcloud"],c=document.createElement("div");if(c.className="fc-row-inner",e.forEach(function(e,t){if(Object.keys(e).length){var n=document.createElement("div");if(n.className="fc-sub-row",0<=a.indexOf(e.source)?u(e,n):d(e,n),e.caption){var r=document.createElement("div");r.className="fc-sub-caption",r.innerHTML=e.caption,n.appendChild(r)}c.appendChild(n)}}),c.childNodes.length)return c},y=function(e){var i=document.createElement("div");return i.className="fc-sub-rows",e.forEach(function(e,t){if(e){var n=document.createElement("div");n.className="fc-sub-row";var r=document.createElement("a");r.href=e.url,r.target="_blank",e.title&&(r.innerHTML=e.title),n.appendChild(r);var a=f(e.url);if(a){var c=document.createElement("div");c.className="fc-sub-url",c.innerHTML=a,n.appendChild(c)}i.appendChild(n)}}),i},g=function(e){var t=document.createElement("a");t.href=e,t.target="_blank",t.innerHTML=e;var n=document.createTextNode("License this photo: "),r=document.createElement("span");return r.appendChild(n),r.appendChild(t),r},d=function(n,r){var a=document.createElement("div");if(a.className="fc-media",n.url){var e=new Image;e.onload=function(e){var t=document.createElement("img");t.src=n.url,a.appendChild(t),r.appendChild(a),r.childNodes?r.insertBefore(a,r.childNodes[0]):r.appendChild(a)},e.onerror=function(e){console.warn("Four Corners cannot load this as an image: "+n.url,e)},e.src=n.url}},u=function(e,r){var t="";switch(e.source){case"youtube":t="https://noembed.com/embed?url="+e.url;break;case"vimeo":t="https://vimeo.com/api/oembed.json?url="+e.url;break;case"soundcloud":t="https://soundcloud.com/oembed?format=json&url="+e.url;break;default:return!1}fetch(t,{method:"GET",headers:{"Content-Type":"application/json"}}).then(function(e){if(!e.ok)throw Error(e.statusText);return e.json()}).then(function(e){var t=document.createElement("div");if(t.className="fc-media",t.innerHTML=e.html,Number.isInteger(e.width,e.height)){var n=e.height/e.width;t.classList.add("fc-responsive"),t.style.paddingBottom=100*n+"%"}r.childNodes?r.insertBefore(t,r.childNodes[0]):r.appendChild(t)}).catch(function(e){r.remove(),console.warn("Four Corners cannot load this media source: "+src,e)})},f=function(e){if(!e)return!1;var t,n=!!(t=e)&&(-1<t.indexOf("//")?t.split("/")[2]:t.split("/")[0]).split(":")[0].split("?")[0],r=n.split("."),a=r.length;return 2<a&&(n=r[a-2]+"."+r[a-1],2==r[a-2].length&&2==r[a-1].length&&(n=r[a-3]+"."+n)),n},m=function(a){var c,i={},o=a.elems.embed,s=(a.elems.photo,a.opts.active);return a.corners.forEach(function(e,t){var n='.fc-corner[data-fc-slug="'+e+'"]';if(!o.querySelector(n)){var r=document.createElement("div");r.dataset.fcSlug=e,r.classList.add("fc-corner"),r.classList.add("fc-"+e),e==s&&r.classList.add("fc-active"),a.data&&((c=a.data[e])&&Object.keys(c).length||r.classList.add("fc-empty")),a.opts.interactive&&(r.addEventListener("mouseenter",function(e){L(e,a)}),r.addEventListener("mouseleave",function(e){E(e,a)}),r.addEventListener("click",function(e){C(e,a)})),i[e]=r,o.appendChild(r)}}),i},p=function(e){if(e.data&&e.opts.cutline){var t=e.data.authorship;if(t&&Object.keys(t).length){var n=e.elems.embed,r=document.createElement("div");r.classList.add("fc-cutline");var a=[];t.credit&&a.push(t.credit);a.push('<a href="#" class="fc">Four Corners</a>');var c=a.join(" ");r.innerHTML=c,n.parentNode.insertBefore(r,n.nextSibling)}}},v=function(e){if(e.elems.embed){var t=e.elems.embed.dataset.fc;if(t)return t=t,delete e.elems.embed.dataset.fc,JSON.parse(t)}},L=function(e,t){e.target.classList.add("fc-hover")},E=function(e,t){e.target.classList.remove("fc-hover")},C=function(e,t){var n=e.target.dataset.fcSlug,r=t.elems.embed.dataset.fcActive;n&&(n==r?t.closeCorner(n):t.openCorner(n))},w=function(e,t){t.closeCorner()},k=function(n,e){var r=!1;return Object.entries(e).forEach(function(e){var t=h(e,2);t[0];t[1].contains(n)&&(r=!0)}),r},j=function(e){var t=e.split(/\n/g);if(t.length<=1)return e;var r=document.createElement("div");return r.className="fc-row-inner",t.forEach(function(e,t){var n=document.createElement("p");n.innerHTML=e,r.appendChild(n)}),r},x=a;t.default=x}])});